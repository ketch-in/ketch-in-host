(function(c,h){typeof exports=="object"&&typeof module!="undefined"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(c=typeof globalThis!="undefined"?globalThis:c||self,h(c.ketchInComponents={}))})(this,function(c){"use strict";var I=Object.defineProperty,U=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var S=(c,h,d)=>h in c?I(c,h,{enumerable:!0,configurable:!0,writable:!0,value:d}):c[h]=d,g=(c,h)=>{for(var d in h||(h={}))j.call(h,d)&&S(c,d,h[d]);if(T)for(var d of T(h))G.call(h,d)&&S(c,d,h[d]);return c},E=(c,h)=>U(c,V(h));var r=(c,h,d)=>(S(c,typeof h!="symbol"?h+"":h,d),d);var h="";const d={removeDelay:2e3};class p{constructor(n,t,e=!1){r(this,"target");r(this,"options");this.target=n,this.options=t||{},!e&&this.clear()}getOption(n){return this.options[n]||d[n]}clear(){this.target.innerText=""}}const x="ketch-in-components";function M(u,n){const t=document.createElement(u,n);return t.className=x,t}class C{constructor({data:n,defaultClassName:t,removeDelay:e=2e3}){r(this,"data");r(this,"state");r(this,"element");r(this,"defaultClassName");r(this,"removeDelay");this.data=n,this.state="unmount",this.defaultClassName=t||"",this.removeDelay=e,this.element=this.createElement("div"),this.element.classList.add("container")}setRemoveDelay(n){return this.removeDelay=n,this}getRemoveDelay(){return this.removeDelay}createElement(n,t){const e=M(n,t);return e.classList.add(this.defaultClassName),e}createSVGElement(n,t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");return s.setAttribute("width",n.toString()),s.setAttribute("height",t.toString()),s.classList.add(this.defaultClassName),s}getData(){return this.data}setState(n){return this.state=n,this.isUnmounting()?this.element.classList.add("unmount"):this.element.classList.remove("unmount"),this}getState(){return this.state}getElement(){return this.element}isMount(){return this.getState()==="mount"}isUnmount(){return this.getState()==="unmount"}isUnmounting(){return this.getState()==="unmounting"}async clear(){return this.isUnmount()||await this.unmount(),this.element=this.createElement("div"),this}async mount(n){return this.isMount()&&await this.unmount(),n.append(this.element),this.setState("mount")}unmount(){return new Promise(n=>{if(!this.isMount()){const t=setInterval(()=>{if(this.isUnmount())return clearInterval(t),n(this)},1e3)}this.setState("unmounting"),setTimeout(()=>{this.element.parentElement&&this.element.parentElement.removeChild(this.element),this.setState("unmount").clear().then(()=>n(this))},this.getRemoveDelay())})}}class k extends C{constructor({children:t,removeDelay:e,data:s={},onClose:o=()=>{}}){super({data:s,removeDelay:e,defaultClassName:"modal"});r(this,"children");r(this,"onClose");this.children=t,this.onClose=()=>o(this)}mount(t){const e=this.getElement(),s=this.createElement("div");s.append(this.children),s.classList.add("body"),e.appendChild(s);const o=this.createElement("span");return o.innerText="\uB2EB\uAE30",o.classList.add("close"),o.onclick=()=>{o.onclick=()=>{},this.unmount().then(this.onClose)},e.appendChild(o),super.mount(t)}}class D extends p{constructor(n,t){super(n,t)}add(n){return new k(E(g({},n),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}class F extends C{constructor({children:t,buttons:e,removeDelay:s,data:o={},onClick:a=()=>{},onClose:i=()=>{}}){super({data:o,removeDelay:s,defaultClassName:"select-modal"});r(this,"children");r(this,"buttons");r(this,"onClose");r(this,"onClick");this.children=t,this.buttons=e,this.onClick=(l,m,y)=>(a(l,m,y),this),this.onClose=()=>i(this)}click(t){return super.unmount().then(()=>this.onClick(this,t,this.buttons[t]))}mount(t){const e=this.getElement(),s=this.createElement("div");s.append(this.children),s.classList.add("body"),e.appendChild(s);const o=this.createElement("span");o.innerText="\uB2EB\uAE30",o.classList.add("close"),o.onclick=()=>{o.onclick=()=>{},this.unmount().then(this.onClose)},e.appendChild(o);const a=this.createElement("div");return a.classList.add("btns"),e.appendChild(a),Object.keys(this.buttons).map(i=>{const l=this.createElement("button");l.classList.add(i),l.classList.add("btn"),l.innerText=this.buttons[i],l.onclick=()=>{l.onclick=()=>{},this.click(i)},a.append(l)}),super.mount(t)}}class B extends p{constructor(n,t){super(n,t)}add(n){return new F(E(g({},n),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}class A extends C{constructor({data:t,removeDelay:e,defaultClassName:s,momentDelay:o=2e3}){super({data:t,removeDelay:e,defaultClassName:s});r(this,"momentDelay");r(this,"momentTimeout");this.momentDelay=o,this.momentTimeout=null}setMomentTimeout(t){return this.momentTimeout=t,this}async mount(t){return super.mount(t).then(()=>this.setMomentTimeout(setTimeout(()=>this.unmount(),this.momentDelay)))}unmount(){return this.momentTimeout&&(clearTimeout(this.momentTimeout),this.setMomentTimeout(null)),super.unmount()}}class _ extends A{constructor({children:t,data:e={},removeDelay:s=2e3,momentDelay:o=2e3,onClick:a=()=>{},onClose:i=()=>{}}){super({removeDelay:s,momentDelay:o,data:e,defaultClassName:"toast"});r(this,"children");r(this,"onClick");r(this,"onClose");this.children=t,this.onClick=a,this.onClose=l=>i(this,l)}mount(t){const e=this.getElement(),s=this.createElement("div"),o=this.createElement("span");return s.append(this.children),o.innerText="\uB2EB\uAE30",s.classList.add("text"),o.classList.add("close"),e.appendChild(s),e.appendChild(o),e.onclick=a=>{e.onclick=()=>{},!a.composedPath().some(i=>i===o)&&this.unmount(!0).then(this.onClick)},o.onclick=()=>{o.onclick=()=>{},this.unmount(!0)},super.mount(t)}unmount(t=!1){if(this.isMount()){const e=this.onClose(t),s=!!e||e===0?e:this.getRemoveDelay();this.setRemoveDelay(s)}return super.unmount()}}class z extends p{constructor(n,t){super(n,t)}add(n){return new _(E(g({},n),{removeDelay:this.getOption("removeDelay")})).mount(this.target)}}const O=["#000000","#262626","#363636","#555555","#737373","#999999","#B2B2B2","#C7C7C7","#DBDBDB","#EFEFEF","#FFFFFF","#EF848C","#FFDEDE","#FFE3C7","#FFC47B","#CEF3FB","#A3DED0","#EE4753","#FF8C1C","#FFCC51","#70C050","#174A28","#3897F0","#1AA39C","#89C4F4","#1C8BC3","#004E82","#684172","#9B6336","#003960","#1E3993","#5300D2","#740060","#4F0041","#432223"];class v extends C{constructor({removeDelay:t,onColorSelect:e=()=>{}}){super({removeDelay:t,defaultClassName:"toolbar__color-palette"});r(this,"onColorSelect");this.onColorSelect=e}mount(t){var o;const e=this.getElement(),s=this.createElement("ul");return O.map(a=>{const i=this.createElement("li"),l=this.createElement("label");l.style.width="27px",l.style.height="27px",l.style.display="inline-block",l.classList.add("color-unit"),l.dataset.color=a,l.style.backgroundColor=a,i.classList.add(`btn-${a}`),i.appendChild(l),s.appendChild(i)}),s.classList.add("wrapper"),e.appendChild(s),s.onclick=a=>{const i=a.target;if(i.closest("li")){const l=i.dataset.color;l&&this.onColorSelect(l)}},(o=document.querySelector(".toolbar"))==null||o.addEventListener("click",a=>{a.target.contains(e)||this.unmount().then(this.onClose)}),super.mount(t)}unMount(){this.unmount()}onClose(){document.body.onclick=null}}class P extends p{constructor(t,e){super(t,e,!0);r(this,"layer")}open(t){if(this.layer=new v(E(g({},t),{removeDelay:0})),this.layer instanceof v)return this.layer.mount(this.target)}close(){if(this.layer instanceof v)return this.layer.unMount()}}const b={rect:"<rect x='5' y='5' width='10' height='10' fill='none' stroke='grey' />",["rounded-rect"]:"<rect x='5' y='5' rx='2' width='10' height='10' fill='none' stroke='grey' />",circle:"<circle cx='10' cy='10' r='5' fill='none' stroke='grey' />",triangle:"<ellipse cx='10' cy='10' rx='6' ry = '4' fill='none' stroke='grey' />"};class f extends C{constructor({removeDelay:t,onShapeSelect:e=()=>{}}){super({removeDelay:t,defaultClassName:"toolbar__shape-list"});r(this,"onShapeSelect");this.onShapeSelect=e}mount(t){var o;const e=this.getElement(),s=this.createElement("ul");return Object.entries(b).map(([a,i])=>{const l=this.createElement("li"),m=this.createSVGElement(20,20);m.style.backgroundColor="#EEE",m.style.borderRadius="4px",m.innerHTML=i,m.dataset.shape=a,l.classList.add(`btn-${a}`),l.appendChild(m),s.appendChild(l)}),s.classList.add("wrapper"),e.appendChild(s),s.onclick=a=>{const i=a.target;if(i.closest("li")){const l=i.dataset.shape;l&&this.onShapeSelect({type:l,svg:b[l]})}},(o=document.querySelector(".toolbar"))==null||o.addEventListener("click",a=>{a.target.contains(e)||this.unmount().then(this.onClose)}),super.mount(t)}unMount(){this.unmount()}onClose(){document.body.onclick=null}}class H extends p{constructor(t,e){super(t,e,!0);r(this,"layer")}open(t){if(this.layer=new f(E(g({},t),{removeDelay:0})),this.layer instanceof f)return this.layer.mount(this.target)}close(){if(this.layer instanceof f)return this.layer.unMount()}}class N extends C{constructor({data:t={},status:e="",handlePen:s=()=>{},handleShape:o=()=>{},handleColor:a=()=>{},onClear:i=()=>{}}){super({data:t,defaultClassName:"toolbar"});r(this,"status");r(this,"handlePen");r(this,"handleShape");r(this,"handleColor");r(this,"onClear");this.status=e,this.handlePen=s,this.handleShape=o,this.handleColor=a,this.onClear=i}mount(t){const e=this.getElement(),s=this.createElement("span"),o=this.createElement("button"),a=this.createElement("span"),i=this.createElement("span"),l=this.createElement("button"),m=new H(a,{}),y=new P(i,{});return s.innerText=`[${this.status}]`,s.classList.add("status"),o.classList.add("btn_pen"),o.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220.001 220.001">
        <path d="M132.018,34.787l53.197,53.197L69.568,203.631L16.37,150.434L132.018,34.787z M212.696,60.502   c9.738-9.738,9.742-25.527,0-35.268l-17.93-17.93c-9.738-9.74-25.529-9.738-35.268,0l-17.346,17.347l53.199,53.196L212.696,60.502z   "/>
        <polygon points="0,220 59.34,213.86 6.143,160.661  "/>
      </svg>`,a.classList.add("select_shape"),a.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path fill="none" d="M0 0h24v24H0z"/>
        <path d="M5 8a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm14 0a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 14a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM5 22a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM9 4h6v2H9V4zm0 14h6v2H9v-2zM4 9h2v6H4V9zm14 0h2v6h-2V9z"/>
      </svg>`,i.classList.add("palette"),i.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <rect width="24" height="24" opacity="0"/>
        <path d="M19.54 5.08A10.61 10.61 0 0 0 11.91 2a10 10 0 0 0-.05 20 2.58 2.58 0 0 0 2.53-1.89 2.52 2.52 0 0 0-.57-2.28.5.5 0 0 1 .37-.83h1.65A6.15 6.15 0 0 0 22 11.33a8.48 8.48 0 0 0-2.46-6.25zM15.88 15h-1.65a2.49 2.49 0 0 0-1.87 4.15.49.49 0 0 1 .12.49c-.05.21-.28.34-.59.36a8 8 0 0 1-7.82-9.11A8.1 8.1 0 0 1 11.92 4H12a8.47 8.47 0 0 1 6.1 2.48 6.5 6.5 0 0 1 1.9 4.77A4.17 4.17 0 0 1 15.88 15z"/>
        <circle cx="12" cy="6.5" r="1.5"/>
        <path d="M15.25 7.2a1.5 1.5 0 1 0 2.05.55 1.5 1.5 0 0 0-2.05-.55z"/>
        <path d="M8.75 7.2a1.5 1.5 0 1 0 .55 2.05 1.5 1.5 0 0 0-.55-2.05z"/>
        <path d="M6.16 11.26a1.5 1.5 0 1 0 2.08.4 1.49 1.49 0 0 0-2.08-.4z"/>
      </svg>`,l.classList.add("btn_clear"),l.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
        <path xmlns="http://www.w3.org/2000/svg" d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm2.121.707a1 1 0 0 0-1.414 0L4.16 7.547l5.293 5.293 4.633-4.633a1 1 0 0 0 0-1.414l-3.879-3.879zM8.746 13.547 3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/>
      </svg>`,e.appendChild(s),e.appendChild(o),e.appendChild(a),e.appendChild(i),e.appendChild(l),o.onclick=this.handlePen,a.onclick=L=>{L.stopPropagation(),a.children.length===1?m.open({onShapeSelect:w=>this.handleShape(w)}):m.close()},i.onclick=L=>{L.stopPropagation(),i.children.length===1?y.open({onColorSelect:w=>this.handleColor(w)}):y.close()},l.onclick=this.onClear,super.mount(t)}}class R extends p{constructor(n,t){super(n,t)}add(n){return new N(n).mount(this.target)}}c.ModalController=D,c.SelectModalController=B,c.ToastController=z,c.ToolbarController=R,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
